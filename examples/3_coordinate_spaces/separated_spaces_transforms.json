{
  "@context": {
    "@language": "en",
    "@vocab": "https://schema.org/",
    "cr": "http://mlcommons.org/croissant/",
    "dct": "http://purl.org/dc/terms/",
    "sc": "https://schema.org/"
  },
  "@type": "sc:Dataset",
  "name": "separated-spaces-transforms",
  "description": "Example Croissant dataset demonstrating coordinate spaces and transforms defined in separate source tables",
  "dct:conformsTo": "http://mlcommons.org/croissant/1.0",
  "cr:citeAs": "@misc{separated-spaces-transforms, title={Separated Coordinate Spaces and Transforms}, author={NOID Project}, year={2025}}",
  "license": "https://creativecommons.org/licenses/by/4.0/",
  "url": "https://github.com/nclack/noid/examples/separated_spaces_transforms.json",
  "version": "1.0.0",
  "datePublished": "2025-01-13",
  
  "distribution": [
    {
      "@type": "cr:FileObject",
      "name": "coordinate_spaces_table.csv",
      "description": "Table defining all coordinate spaces used in the dataset",
      "contentUrl": "coordinate_spaces_table.csv",
      "encodingFormat": "text/csv",
      "sha256": "abcdef0123456789abcdef0123456789abcdef0123456789abcdef0123456789"
    },
    {
      "@type": "cr:FileObject", 
      "name": "transforms_table.csv",
      "description": "Table defining coordinate transformations between spaces",
      "contentUrl": "transforms_table.csv",
      "encodingFormat": "text/csv",
      "sha256": "fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210"
    },
    {
      "@type": "cr:FileObject",
      "name": "imaging_data.zarr",
      "description": "Multi-resolution imaging data in OME-Zarr format",
      "contentUrl": "imaging_data.zarr",
      "encodingFormat": "application/zarr",
      "sha256": "0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef"
    }
  ],

  "cr:recordSet": [
    {
      "@type": "cr:RecordSet",
      "name": "coordinate_spaces",
      "description": "Coordinate space definitions with their dimensions",
      "cr:field": [
        {
          "@type": "cr:Field",
          "name": "space_id",
          "description": "Unique identifier for the coordinate space",
          "cr:dataType": "sc:Text"
        },
        {
          "@type": "cr:Field", 
          "name": "space_name",
          "description": "Human-readable name for the coordinate space",
          "cr:dataType": "sc:Text"
        },
        {
          "@type": "cr:Field",
          "name": "description", 
          "description": "Description of what this coordinate space represents",
          "cr:dataType": "sc:Text"
        },
        {
          "@type": "cr:Field",
          "name": "dimensions",
          "description": "JSON array of dimension objects defining the coordinate space",
          "cr:dataType": "sc:Text",
          "cr:source": {
            "cr:fileSet": {
              "cr:includes": "coordinate_spaces_table.csv"
            },
            "cr:extract": {
              "cr:column": "dimensions"
            },
            "cr:transform": {
              "cr:jsonPath": "$"
            }
          }
        }
      ],
      "cr:data": [
        {
          "space_id": "raw_pixel_space",
          "space_name": "Raw Pixel Coordinates", 
          "description": "Native pixel coordinates from the microscope detector",
          "dimensions": "[{\"name\": \"x\", \"unit\": \"index\", \"type\": \"space\"}, {\"name\": \"y\", \"unit\": \"index\", \"type\": \"space\"}, {\"name\": \"z\", \"unit\": \"index\", \"type\": \"space\"}]"
        },
        {
          "space_id": "stage_coordinates",
          "space_name": "Stage Coordinates",
          "description": "Physical coordinates of the microscope stage",
          "dimensions": "[{\"name\": \"x\", \"unit\": \"micrometer\", \"type\": \"space\"}, {\"name\": \"y\", \"unit\": \"micrometer\", \"type\": \"space\"}, {\"name\": \"z\", \"unit\": \"micrometer\", \"type\": \"space\"}]"
        },
        {
          "space_id": "world_coordinates",
          "space_name": "Registered World Coordinates",
          "description": "Globally registered coordinate system across all samples",
          "dimensions": "[{\"name\": \"x\", \"unit\": \"micrometer\", \"type\": \"space\"}, {\"name\": \"y\", \"unit\": \"micrometer\", \"type\": \"space\"}, {\"name\": \"z\", \"unit\": \"micrometer\", \"type\": \"space\"}]"
        },
        {
          "space_id": "time_series",
          "space_name": "Time Series Coordinates",
          "description": "Temporal coordinates for time-lapse imaging",
          "dimensions": "[{\"name\": \"t\", \"unit\": \"second\", \"type\": \"time\"}]"
        },
        {
          "space_id": "spectral_space",
          "space_name": "Spectral Coordinates",
          "description": "Spectral/wavelength coordinates for hyperspectral data",
          "dimensions": "[{\"name\": \"wavelength\", \"unit\": \"arbitrary\", \"type\": \"other\"}]"
        }
      ]
    },

    {
      "@type": "cr:RecordSet", 
      "name": "coordinate_transforms",
      "description": "Coordinate transformations linking different coordinate spaces",
      "cr:field": [
        {
          "@type": "cr:Field",
          "name": "transform_id", 
          "description": "Unique identifier for the coordinate transform",
          "cr:dataType": "sc:Text"
        },
        {
          "@type": "cr:Field",
          "name": "transform_name",
          "description": "Human-readable name for the transformation",
          "cr:dataType": "sc:Text"
        },
        {
          "@type": "cr:Field",
          "name": "description",
          "description": "Description of what this transformation does",
          "cr:dataType": "sc:Text"
        },
        {
          "@type": "cr:Field",
          "name": "input_space_id",
          "description": "Reference to input coordinate space ID",
          "cr:dataType": "sc:Text",
          "cr:references": {
            "cr:field": "coordinate_spaces/space_id"
          }
        },
        {
          "@type": "cr:Field", 
          "name": "output_space_id",
          "description": "Reference to output coordinate space ID", 
          "cr:dataType": "sc:Text",
          "cr:references": {
            "cr:field": "coordinate_spaces/space_id"
          }
        },
        {
          "@type": "cr:Field",
          "name": "transform_type",
          "description": "Type of coordinate transformation",
          "cr:dataType": "sc:Text"
        },
        {
          "@type": "cr:Field",
          "name": "parameters",
          "description": "JSON object containing transformation parameters",
          "cr:dataType": "sc:Text"
        }
      ],
      "cr:data": [
        {
          "transform_id": "pixel_to_stage",
          "transform_name": "Pixel to Stage Transform",
          "description": "Convert pixel coordinates to physical stage coordinates using calibration",
          "input_space_id": "raw_pixel_space",
          "output_space_id": "stage_coordinates", 
          "transform_type": "homogeneous",
          "parameters": "{\"matrix\": [[0.65, 0, 0, 1250], [0, 0.65, 0, 890], [0, 0, 2.0, 45], [0, 0, 0, 1]]}"
        },
        {
          "transform_id": "stage_to_world",
          "transform_name": "Stage to World Registration",
          "description": "Register stage coordinates to global world coordinate system",
          "input_space_id": "stage_coordinates",
          "output_space_id": "world_coordinates",
          "transform_type": "homogeneous", 
          "parameters": "{\"matrix\": [[0.998, -0.052, 0.035, 12.5], [0.053, 0.999, -0.017, -8.2], [-0.034, 0.019, 0.999, 3.1], [0, 0, 0, 1]]}"
        },
        {
          "transform_id": "direct_pixel_to_world",
          "transform_name": "Direct Pixel to World",
          "description": "Composite transformation from pixels directly to world coordinates",
          "input_space_id": "raw_pixel_space",
          "output_space_id": "world_coordinates",
          "transform_type": "sequence",
          "parameters": "{\"transforms\": [{\"type\": \"reference\", \"transform_id\": \"pixel_to_stage\"}, {\"type\": \"reference\", \"transform_id\": \"stage_to_world\"}]}"
        },
        {
          "transform_id": "time_shift_correction",
          "transform_name": "Time Synchronization",
          "description": "Correct for temporal offset in time-lapse acquisition",
          "input_space_id": "time_series", 
          "output_space_id": "time_series",
          "transform_type": "translation",
          "parameters": "{\"translation\": [-15.3]}"
        },
        {
          "transform_id": "spectral_calibration",
          "transform_name": "Spectral Wavelength Calibration", 
          "description": "Map spectral channel indices to physical wavelengths",
          "input_space_id": "spectral_space",
          "output_space_id": "spectral_space", 
          "transform_type": "scale",
          "parameters": "{\"scale\": [2.5], \"offset\": [450]}"
        }
      ]
    },

    {
      "@type": "cr:RecordSet",
      "name": "imaging_arrays",
      "description": "Multi-dimensional imaging arrays with coordinate space references",
      "cr:field": [
        {
          "@type": "cr:Field",
          "name": "array_id",
          "description": "Unique identifier for the imaging array",
          "cr:dataType": "sc:Text"
        },
        {
          "@type": "cr:Field",
          "name": "array_path",
          "description": "Path to array within the zarr file",
          "cr:dataType": "sc:Text"
        },
        {
          "@type": "cr:Field",
          "name": "coordinate_space_id",
          "description": "Reference to the coordinate space for this array",
          "cr:dataType": "sc:Text",
          "cr:references": {
            "cr:field": "coordinate_spaces/space_id"
          }
        },
        {
          "@type": "cr:Field",
          "name": "shape",
          "description": "Shape of the array along each dimension",
          "cr:dataType": "sc:Text"
        },
        {
          "@type": "cr:Field",
          "name": "dtype",
          "description": "Data type of array elements",
          "cr:dataType": "sc:Text"
        }
      ],
      "cr:data": [
        {
          "array_id": "raw_image_stack",
          "array_path": "/raw/image_stack",
          "coordinate_space_id": "raw_pixel_space",
          "shape": "[2048, 2048, 100]",
          "dtype": "uint16"
        },
        {
          "array_id": "registered_stack",
          "array_path": "/processed/registered_stack", 
          "coordinate_space_id": "world_coordinates",
          "shape": "[2048, 2048, 100]",
          "dtype": "uint16"
        },
        {
          "array_id": "time_series_data",
          "array_path": "/timeseries/fluorescence",
          "coordinate_space_id": "time_series",
          "shape": "[500]",
          "dtype": "float32"
        }
      ]
    }
  ]
}